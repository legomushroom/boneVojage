(function(){window.boneVojage=function(g,h){window.boneVojage_main={settings:{$body:$("body"),$window:$(window),$document:$(document),$body_html:$("body,html"),currPoint:0,tryPositionCount:0,points:[],$modalTop:0,$modalBottom:0,$modalLeft:0,$modalRight:0,$tooltip:0},options:{delay:1E3,offset:4,positionPriority:"bottom top left right bottom_left bottom_right top_left top_right".split(" "),position:"best",button_next:39,button_prev:37,map:!0,buttons:!0,onNavigation:!1},constructor:function(a){boneVojage_main.settings.$body.append('<div id="modal_top"></div><div id="modal_bottom"></div><div id="modal_left"></div><div id="modal_right"></div><div id="tooltip"><div id="close"></div><div id="text"></div>'+
(boneVojage_main.options.buttons?'<div id="buttons"><div id="prev">prev</div><div id="next">next</div></div>':"")+"<ul></ul></div>");boneVojage_main.settings.$modalTop=$("div#modal_top");boneVojage_main.settings.$modalBottom=$("div#modal_bottom");boneVojage_main.settings.$modalLeft=$("div#modal_left");boneVojage_main.settings.$modalRight=$("div#modal_right");boneVojage_main.settings.$tooltip=$("div#tooltip");boneVojage_main.settings.points=a;boneVojage_main.settings.scrollBeforeVojageY=boneVojage_main.settings.$window.scrollTop();
boneVojage_main.settings.scrollBeforeVojageX=boneVojage_main.settings.$window.scrollLeft();boneVojage_main.options.map&&boneVojage_main.O.makeMap();boneVojage_main.O.makeModalPosition(a[boneVojage_main.settings.currPoint].selector,boneVojage_main.options.offset).done(function(){return boneVojage_main.O.showModal()});return boneVojage_main.E.listen()},E:{listen:function(){boneVojage_main.settings.$document.on("keyup",function(a){switch(a.keyCode){case parseInt(boneVojage_main.options.button_next,10):if(boneVojage_main.settings.currPoint<
boneVojage_main.settings.points.length-1)return boneVojage_main.O.next();break;case parseInt(boneVojage_main.options.button_prev,10):if(0<boneVojage_main.settings.currPoint)return boneVojage_main.O.prev()}});return boneVojage_main.settings.$tooltip.on("click","#next",function(){return boneVojage_main.O.next()}).on("click","#prev",function(){return boneVojage_main.O.prev()}).on("click","#close",function(){boneVojage_main.settings.tryPositionCount=0;boneVojage_main.O.hideModal();return boneVojage_main.settings.$body_html.animate({scrollTop:boneVojage_main.settings.scrollBeforeVojageY,
scrollLeft:boneVojage_main.settings.scrollBeforeVojageX},boneVojage_main.options.delay)}).on("click","li",boneVojage_main.O.makeVojageProgress)}},O:{makeMap:function(){var a,b,d;b="";a=0;for(d=g.length-1;0<=d?a<=d:a>=d;0<=d?a++:a--)b+="<li></li>";return boneVojage_main.settings.$tooltip.find("ul").html(b)},makeVojageProgress:function(){boneVojage_main.settings.tryPositionCount=0;boneVojage_main.settings.currPoint=$(this).index();var a=boneVojage_main.settings.currPoint;if(!1!==boneVojage_main.options.onNavigation)boneVojage_main.options.onNavigation(a+
1);return boneVojage_main.O.makeModalPosition(boneVojage_main.settings.points[a].selector,boneVojage_main.options.offset).done(function(){return boneVojage_main.O.showModal()})},next:function(){boneVojage_main.settings.tryPositionCount=0;var a=++boneVojage_main.settings.currPoint;if(!1!==boneVojage_main.options.onNavigation)boneVojage_main.options.onNavigation(a+1);return boneVojage_main.O.makeModalPosition(boneVojage_main.settings.points[a].selector,boneVojage_main.options.offset).done(function(){return boneVojage_main.O.showModal()})},
prev:function(){boneVojage_main.settings.tryPositionCount=0;var a=--boneVojage_main.settings.currPoint;if(!1!==boneVojage_main.options.onNavigation)boneVojage_main.options.onNavigation(a+1);return boneVojage_main.O.makeModalPosition(boneVojage_main.settings.points[a].selector,boneVojage_main.options.offset).done(function(){return boneVojage_main.O.showModal()})},getGSides:function(a){var b;b=boneVojage_main.settings.$tooltip.outerWidth()>a.outerWidth()?a.offset().left+a.outerWidth()+Math.abs(a.outerWidth()-
boneVojage_main.settings.$tooltip.outerWidth())/2:a.offset().left+a.outerWidth();a=boneVojage_main.settings.$tooltip.outerWidth()>a.outerWidth()?a.offset().left-Math.abs(a.outerWidth()-boneVojage_main.settings.$tooltip.outerWidth())/2:a.offset().left;return{g_right:b,g_left:a}},makeTooltipPosition:function(a,b,d){var c;c=boneVojage_main.O.getPosition(b);boneVojage_main.settings.$tooltip.css({position:c.fixed});"best"!==a&&(boneVojage_main.settings.$tooltip.attr("class",""),boneVojage_main.settings.$tooltip.addClass(a));
switch(a){case "left":boneVojage_main.settings.$tooltip.css({top:b.offset().top-boneVojage_main.settings.$tooltip.outerHeight()/2+b.outerHeight()/2-c.normH,left:b.offset().left-boneVojage_main.settings.$tooltip.outerWidth()-d-c.normY});break;case "right":boneVojage_main.settings.$tooltip.css({top:b.offset().top-boneVojage_main.settings.$tooltip.outerHeight()/2+b.outerHeight()/2-c.normH,left:b.offset().left+b.outerWidth()+d-c.normY});break;case "top":boneVojage_main.settings.$tooltip.css({top:b.offset().top-
boneVojage_main.settings.$tooltip.outerHeight()-d-7-c.normH,left:b.offset().left+b.outerWidth()/2-boneVojage_main.settings.$tooltip.outerWidth()/2-c.normY});break;case "top_left":boneVojage_main.settings.$tooltip.css({top:b.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-7-c.normH,left:b.offset().left-boneVojage_main.settings.$tooltip.outerWidth()-c.normY});break;case "top_right":boneVojage_main.settings.$tooltip.css({top:b.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-
7-c.normH,left:b.offset().left+b.outerWidth()-c.normY});break;case "bottom":boneVojage_main.settings.$tooltip.css({top:b.offset().top+b.outerHeight()+d-c.normH,left:b.offset().left+b.outerWidth()/2-boneVojage_main.settings.$tooltip.outerWidth()/2-c.normY});break;case "bottom_right":boneVojage_main.settings.$tooltip.css({top:b.offset().top+b.outerHeight()-c.normH,left:b.outerWidth()+b.offset().left-c.normY});break;case "bottom_left":boneVojage_main.settings.$tooltip.css({top:b.offset().top+b.outerHeight()-
c.normH,left:b.offset().left-boneVojage_main.settings.$tooltip.outerWidth()-c.normY});break;case "best":a=boneVojage_main.settings.tryPositionCount++,a<boneVojage_main.options.positionPriority.length?boneVojage_main.O.makeTooltipPosition(boneVojage_main.O.tryPosition[boneVojage_main.options.positionPriority[a]](b,boneVojage_main.options.offset),b,boneVojage_main.options.offset):boneVojage_main.O.makeTooltipPosition(boneVojage_main.options.positionPriority[0],b,boneVojage_main.options.offset)}return b},
tryPosition:{left:function(a,b){return a.offset().left-boneVojage_main.settings.$tooltip.outerWidth()-b>boneVojage_main.settings.$window.scrollLeft()&&a.offset().top-Math.abs(a.outerHeight()-boneVojage_main.settings.$tooltip.outerHeight())/2>boneVojage_main.settings.$window.scrollTop()&&a.offset().top+Math.abs(a.outerHeight()-boneVojage_main.settings.$tooltip.outerHeight())/2<boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight()?"left":"best"},right:function(a,
b){return a.offset().left+a.outerWidth()+b<boneVojage_main.settings.$window.scrollLeft()+boneVojage_main.settings.$window.outerWidth()&&a.offset().top-Math.abs(a.outerHeight()-boneVojage_main.settings.$tooltip.outerHeight())/2>boneVojage_main.settings.$window.scrollTop()&&a.offset().top+Math.abs(a.outerHeight()-boneVojage_main.settings.$tooltip.outerHeight())/2<boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight()?"right":"best"},top:function(a,b){var d;d=boneVojage_main.O.getGSides(a);
return a.offset().top-b-boneVojage_main.settings.$tooltip.outerHeight()>boneVojage_main.settings.$window.scrollTop()&&d.g_left>boneVojage_main.settings.$window.scrollLeft()&&d.g_right<boneVojage_main.settings.$window.outerWidth()+boneVojage_main.settings.$window.scrollLeft()?"top":"best"},top_left:function(a,b){return a.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-b-boneVojage_main.settings.$tooltip.outerHeight()>boneVojage_main.settings.$window.scrollTop()&&a.offset().left-boneVojage_main.settings.$tooltip.outerWidth()>
boneVojage_main.settings.$window.scrollLeft()?"top_left":"best"},top_right:function(a,b){return a.offset().top-boneVojage_main.settings.$tooltip.outerHeight()-b-boneVojage_main.settings.$tooltip.outerHeight()>boneVojage_main.settings.$window.scrollTop()&&a.offset().left+a.outerWidth()+boneVojage_main.settings.$tooltip.outerWidth()<boneVojage_main.settings.$window.scrollLeft()+boneVojage_main.settings.$window.outerWidth()?"top_right":"best"},bottom:function(a,b){var d;d=boneVojage_main.O.getGSides(a);
return a.offset().top+a.outerHeight()+b+boneVojage_main.settings.$tooltip.outerHeight()<boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight()&&d.g_left>boneVojage_main.settings.$window.scrollLeft()&&d.g_right<boneVojage_main.settings.$window.scrollLeft()+boneVojage_main.settings.$window.outerWidth()?"bottom":"best"},bottom_left:function(a,b){return a.offset().top+a.outerHeight()+b+boneVojage_main.settings.$tooltip.outerHeight()<boneVojage_main.settings.$window.scrollTop()+
boneVojage_main.settings.$window.outerHeight()&&a.offset().left-boneVojage_main.settings.$tooltip.outerWidth()>boneVojage_main.settings.$window.scrollLeft()?"bottom_left":"best"},bottom_right:function(a,b){return a.offset().top+a.outerHeight()+b+boneVojage_main.settings.$tooltip.outerHeight()<boneVojage_main.settings.$window.scrollTop()+boneVojage_main.settings.$window.outerHeight()&&a.offset().left+a.outerWidth()+boneVojage_main.settings.$tooltip.outerWidth()<boneVojage_main.settings.$window.scrollLeft()+
boneVojage_main.settings.$window.outerWidth()?"bottom_right":"best"}},showModal:function(){boneVojage_main.settings.$modalTop.fadeIn();boneVojage_main.settings.$modalBottom.fadeIn();boneVojage_main.settings.$modalLeft.fadeIn();boneVojage_main.settings.$modalRight.fadeIn();return boneVojage_main.settings.$tooltip.fadeIn()},addControls:function(){boneVojage_main.settings.currPoint<boneVojage_main.settings.points.length-1&&boneVojage_main.settings.$tooltip.find("#next").show();if(0<boneVojage_main.settings.currPoint)return boneVojage_main.settings.$tooltip.find("#prev").show()},
hideModal:function(){boneVojage_main.settings.$tooltip.find("#next,#prev").hide();boneVojage_main.settings.$tooltip.hide();boneVojage_main.settings.$modalTop.hide();boneVojage_main.settings.$modalBottom.hide();boneVojage_main.settings.$modalLeft.hide();return boneVojage_main.settings.$modalRight.hide()},getPosition:function(a){var b,d,c,e;b=a.css("position");d=a.offset().top-boneVojage_main.settings.$window.outerHeight()/2;c=a.offset().left-boneVojage_main.settings.$window.outerWidth()/2;e=a=0;"fixed"!==
b?b="absolute":(d=boneVojage_main.settings.$window.scrollTop(),c=boneVojage_main.settings.$window.scrollLeft(),a=boneVojage_main.settings.$window.scrollTop(),e=boneVojage_main.settings.$window.scrollLeft());return{fixed:b,normH:a,normY:e,normScrollH:d,normScrollY:c}},makeModalPosition:function(a){var b,d,c,e,f;b=$(a);e=boneVojage_main.O.getPosition(b);boneVojage_main.O.hideModal();c=$.Deferred();d=0;f=boneVojage_main.options.offset;boneVojage_main.settings.$tooltip.find("li").eq(boneVojage_main.settings.currPoint).addClass("active").siblings().removeClass("active");
boneVojage_main.settings.$body_html.stop(!0,!1).animate({scrollTop:e.normScrollH,scrollLeft:e.normScrollY},boneVojage_main.options.delay,function(){if(0===d++)return c.resolve(),boneVojage_main.settings.$modalTop.css({position:e.fixed,height:b.offset().top-f-e.normH,width:b.outerWidth()+2*f,left:b.offset().left-f-e.normY}),boneVojage_main.settings.$modalBottom.css({position:e.fixed,height:$(document).outerHeight()-b.offset().top-b.outerHeight()-f+e.normY,width:b.outerWidth()+2*f,left:b.offset().left-
f-e.normY,top:b.offset().top+b.outerHeight()+f-e.normH}),boneVojage_main.settings.$modalLeft.css({position:e.fixed,width:boneVojage_main.settings.$body.outerWidth()-(boneVojage_main.settings.$body.outerWidth()-b.offset().left)-f-e.normY,height:$(document).outerHeight()-e.normH}),boneVojage_main.settings.$modalRight.css({position:e.fixed,left:b.offset().left+b.outerWidth()+f-e.normY,height:$(document).outerHeight()-e.normH,width:boneVojage_main.settings.$body.outerWidth()-(b.offset().left+b.outerWidth())-
f}),boneVojage_main.settings.$tooltip.find("#text").text(boneVojage_main.settings.points[boneVojage_main.settings.currPoint].text),boneVojage_main.O.addControls(),boneVojage_main.O.makeTooltipPosition(boneVojage_main.options.position,b,f)});return c.promise()}}};boneVojage_main.options=$.extend({},boneVojage_main.options,h||{});return boneVojage_main.constructor(g)}}).call(this);